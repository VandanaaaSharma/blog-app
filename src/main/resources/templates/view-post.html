<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title th:text="${post.title}">Post</title>

    <style>
        body { font-family: Arial; background: #f4f5fb; margin: 0; }
        .container {
            max-width: 800px;
            margin: 30px auto;
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.12);
        }
        .meta { font-size: 12px; color: #777; margin-bottom: 12px; }
        textarea { width: 100%; }
        .actions a, .actions button {
            margin-right: 12px;
            text-decoration: none;
            font-size: 14px;
        }
        .btn-delete { color: red; border: none; background: none; cursor: pointer; }
    </style>
</head>

<body>

<div class="container">

    <a href="/">‚¨Ö Back to Home</a>

    <h1 th:text="${post.title}"></h1>

    <div class="meta">
        <span th:text="'Posted by: ' + ${post.createdBy}"></span> ¬∑
        <span th:text="${#temporals.format(post.createdAt, 'dd MMM yyyy HH:mm')}"></span>
    </div>

    <div th:text="${post.summary}" style="font-weight:bold; margin-bottom:10px;"></div>

    <div th:text="${post.content}" style="white-space:pre-wrap;"></div>


    <!-- ACTIONS -->
    <div class="actions" style="margin-top:20px;">

        <!-- Edit visible only for owner or admin -->
        <a th:if="${currentUser == post.createdBy or currentUser == 'admin'}"
           th:href="@{'/posts/' + ${post.id} + '/edit'}">
            ‚úè Edit
        </a>

        <!-- Delete visible only for owner or admin -->
        <form th:if="${currentUser == post.createdBy or currentUser == 'admin'}"
              th:action="@{'/posts/' + ${post.id} + '/delete'}"
              method="post"
              style="display:inline;">
            <button class="btn-delete">üóë Delete</button>
        </form>

    </div>

    <hr>

    <!-- COMMENT SECTION -->
    <h3>Comments</h3>

    <div th:each="c : ${post.comments}" style="margin-bottom:10px;">
        <p>
            <strong th:text="${c.createdBy}"></strong> :
            <span th:text="${c.content}"></span>
        </p>
    </div>

    <form th:action="@{'/posts/' + ${post.id} + '/comment'}" method="post">
        <textarea name="content" rows="3" placeholder="Write a comment..." required></textarea><br><br>
        <button type="submit">Submit Comment</button>
    </form>

</div>

</body>
</html>
