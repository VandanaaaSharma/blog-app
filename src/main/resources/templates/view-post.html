<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title th:text="${post.title}">Post</title>
    <style>
        body { font-family: Arial; background: #f4f5fb; margin: 0; }
        header { background: #4c6fff; color:white; padding: 16px 40px; display:flex; justify-content:space-between; }
        header button, header a {
            background:white; color:#4c6fff; padding:8px 16px; border-radius:20px;
            text-decoration:none; border:none; cursor:pointer; font-weight:bold;
        }
        .container { max-width: 800px; margin: 30px auto; background:white; padding:20px; border-radius:12px; }
        .comment-box { margin-top: 20px; }
        .comment { background:#f2f2f2; padding:10px; border-radius:8px; margin-bottom:10px; }
    </style>
</head>
<body>

<header>
    <a th:href="@{/}">← Back</a>

    <form th:action="@{/logout}" method="post">
        <button>Logout</button>
    </form>
</header>

<div class="container">

    <h1 th:text="${post.title}">Title</h1>

    <p>
        <b th:text="${post.author != null ? post.author : 'Unknown'}"></b> ·
        <span th:text="${#temporals.format(post.createdAt, 'dd MMM yyyy HH:mm')}"></span>
    </p>

    <p th:text="${post.content}"></p>

    <!-- Edit/Delete only if this user is owner or admin -->
    <div th:if="${post.createdBy == currentUser || currentUser == 'admin'}">
        <a th:href="@{'/posts/' + ${post.id} + '/edit'}">Edit</a>
        <form th:action="@{'/posts/' + ${post.id} + '/delete'}" method="post" style="display:inline;">
            <button style="color:red;">Delete</button>
        </form>
    </div>

    <hr>

    <h3>Comments</h3>

    <div th:each="c : ${comments}" class="comment">
        <b th:text="${c.createdBy}"></b><br>
        <span th:text="${c.content}"></span>
    </div>

    <div class="comment-box">
        <form th:action="@{'/posts/' + ${post.id} + '/comment'}" method="post">
            <textarea name="content" rows="3" placeholder="Add a comment..." required
                      style="width:100%;"></textarea>
            <button style="margin-top:10px;">Post Comment</button>
        </form>
    </div>

</div>

</body>
</html>
